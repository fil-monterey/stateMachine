OOP Implementation of state machine
